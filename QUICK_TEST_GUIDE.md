# 🚀 快速测试指南

## ✅ 功能已完成

已添加"获取微信信息"功能！新版本APK已安装到手机。

---

## 📱 立即测试

### Step 1: 刷新测试页面

在手机APP中：
1. 刷新测试页面（可能需要重新加载）
2. 或者完全关闭并重新打开APP

### Step 2: 微信登录

1. **点击"💚 微信登录"按钮**
2. **在微信中点击"授权"**
3. **返回APP，看到绿色成功框和code**

### Step 3: 获取微信信息 🆕

1. **登录成功后，会看到新的"👤 获取微信信息"按钮**
2. **点击该按钮**
3. **等待几秒（调用服务器API）**
4. **查看返回的用户信息**

---

## 🎯 预期结果

### 微信登录成功后

应该看到两个按钮：
```
[💚 微信登录]  [👤 获取微信信息]  [🗑️ 清空结果]
```

### 点击"获取微信信息"后

**成功的响应**：
```
✅ 微信用户信息获取成功

UnionID: o6_bmxxxxxxxxxxxxxxxx
OpenID: oXXXXXXXXXXXXXXXXXXXX
昵称: 你的微信昵称
性别: 男/女/未知
国家: 中国
省份: 省份名称
城市: 城市名称
头像URL: http://thirdwx.qlogo.cn/...

完整数据:
{
  "unionid": "...",
  "openid": "...",
  "nickname": "...",
  ...
}
```

---

## 🔍 在Chrome中查看

### 方法1: 测试页面直接显示

绿色成功框会显示所有用户信息，包括UnionID、OpenID等。

### 方法2: Chrome Console查看

打开Chrome DevTools → Console：

```javascript
// 应该看到的日志
🔄 开始获取微信用户信息...
📤 调用服务器API
📥 服务器响应: 200 OK
[用户信息]: {unionid: "...", openid: "...", ...}
✅ 成功获取用户信息
```

### 方法3: Network标签查看

Chrome DevTools → Network：

1. 找到对 `oauth.qsgl.net/api/Wechat/login` 的POST请求
2. 点击查看详情
3. Request Headers:
   ```
   Content-Type: application/json
   Accept: application/json
   ```
4. Request Payload:
   ```json
   {
     "code": "041Xd80w31uCk63rDW0w34Wa162Xd800"
   }
   ```
5. Response:
   ```json
   {
     "unionid": "...",
     "openid": "...",
     "nickname": "...",
     ...
   }
   ```

---

## ⚠️ 可能的错误

### 错误1: "请先进行微信登录"

**原因**: 没有code

**解决**: 先点击"微信登录"按钮获取code

### 错误2: "code参数无效或已过期"

**原因**: code已过期（5分钟有效期）

**解决**: 重新进行微信登录

### 错误3: 网络请求失败

**原因**: 
- 设备没有网络连接
- 服务器不可达
- 防火墙阻止

**解决**: 检查网络连接

---

## 📊 完整测试流程

```
1. 打开365酒水APP
   ↓
2. 加载测试页面
   ↓
3. 点击"微信登录" ✅
   ↓
4. 在微信中授权 ✅
   ↓
5. 返回APP看到code ✅
   ↓
6. 看到"获取微信信息"按钮 🆕
   ↓
7. 点击按钮 🆕
   ↓
8. 等待API响应 🆕
   ↓
9. 显示用户信息（UnionID、OpenID等）🆕
```

---

## 🎉 功能特点

### 1. 自动显示按钮
微信登录成功后，"获取微信信息"按钮会自动显示

### 2. 详细日志
操作日志会实时显示：
- 🚀 开始微信登录
- ✅ 微信登录成功
- 🔄 开始获取用户信息
- 📤 调用服务器API
- 📥 服务器响应
- ✅ 成功获取用户信息

### 3. 错误处理
如果出错，会显示详细的错误信息

### 4. 完整数据展示
显示所有字段：
- UnionID（最重要）
- OpenID
- 昵称
- 性别
- 地区信息
- 头像URL

---

## 💡 提示

### UnionID vs OpenID

**UnionID**:
- 同一用户在同一开放平台下的不同应用中，UnionID相同
- 用于跨应用识别用户
- **最重要的用户标识**

**OpenID**:
- 同一用户在不同应用中，OpenID不同
- 用于单个应用内识别用户

### 数据用途

获取到的用户信息可以用于：
1. 用户注册/登录
2. 关联用户账号
3. 获取用户基本信息
4. 个性化推荐

---

## 🚀 立即测试

**请现在执行**：

1. 📱 在手机上刷新APP测试页面
2. 🟢 点击"微信登录"
3. 💚 在微信中授权
4. 👤 点击"获取微信信息"按钮 🆕
5. 👀 查看返回的用户数据

**期待看到完整的用户信息！** 🎉

---

**提示**: 如果遇到任何问题，查看Chrome Console的错误日志！
